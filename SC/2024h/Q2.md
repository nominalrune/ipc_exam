## 問2 サイバー攻撃への対策に関する次の記述を読んで、設問に答えよ。

H社は、従業員 3,000名の製造業であり、H社製品の部品を製造する約500社と取引を行っている。取引先は、H社に設置された取引先向け Web サーバに HTTPS でアクセスし、利用者IDとパスワードでログインした後、H社との取引業務を行っている。また、公開 Web サーバでは、H社製品の紹介に加え、問合せや要望の受付を行っている。いずれの Web サーバが停止しても、業務に支障が出る。

H社では、社内に設置している PC (以下、H-PC という)とは別に、一部の従業員に対して、VPNクライアントソフトウェアを導入したリモート接続用PC(以下、リモート接続用PCをR-PCという)を貸与し、リモートワークを実現している。R-PCとH社との間のVPN通信には、VPN ゲートウェイ (以下、VPN ゲートウェイをVPN-GWといい、H社が使用している VPN-GWをVPN-H という)を使用している。

H社のネットワークは、情報システム部のL部長とT主任を含む6名で運用している。H社のネットワーク構成を図1に示す。

**図1 H社のネットワーク構成**
*L2SW: レイヤー2スイッチ*
*UTM: 統合脅威管理*
*メール: 電子メール*
*注1) H社ドメインの権威 DNS サーバと再帰的な名前解決を行うフルサービスリゾルバを兼ねる。*
*注2) H-PCからインターネットへのHTTP 及び HTTPS 通信を中継する。*

```mermaid
graph TD
    subgraph Internet Space
        direction LR
        R_PC[R-PC]
        Internet[インターネット]
        R_PC -- VPN --> Internet
    end

    subgraph H社
        UTM[UTM]
        Internet -- HTTPS --> UTM

        subgraph DMZ
            L2SW_DMZ[L2SW]
            TradeWeb[取引先向けWebサーバ] --> L2SW_DMZ
            PublicWeb[公開Webサーバ] --> L2SW_DMZ
            DNS[DNSサーバ <sup>1)</sup>] --> L2SW_DMZ
            Proxy[プロキシサーバ <sup>2)</sup>] --> L2SW_DMZ
            Mail[メールサーバ] --> L2SW_DMZ
            VPN_H[VPN-H] --> L2SW_DMZ
        end

        subgraph Internal Segments
            InternalServerSeg[内部サーバセグメント]
            subgraph PCセグメント
                L2SW_PC[L2SW]
                H_PC[H-PC]
                L2SW_PC --> H_PC
            end
        end

        L2SW_DMZ --> UTM
        UTM --> InternalServerSeg
        UTM --> L2SW_PC
    end
```

UTM の機能概要及び設定を表1に、VPN-Hの機能概要及び設定を表2に示す。

**表1 UTMの機能概要及び設定**
| 機能名 | 機能概要 | 設定 |
| :--- | :--- | :--- |
| ファイアウォール機能 | ステートフルパケットインスペクション型であり、送信元の IP アドレスとポート番号、宛先の IP アドレスとポート番号の組合せによる通信の許可と拒否のルールによって通信を制御する。 | 有効 |
| NAT 機能 | (省略) | 有効 |
| IPS 機能 | 不正アクセスの検知方法は、次の2通りを設定できる。<br>アノマリ型: あらかじめ登録したしきい値を超えた通信を異常として検知する。<br>シグネチャ型: あらかじめ登録したシグネチャと一致した通信を異常として検知する。 | 無効 |
| WAF 機能 | 不正アクセスの検知方法は、IPS 機能と同様に、アノマリ型とシグネチャ型を設定できる。 | 無効 |

**表2 VPN-H の機能概要及び設定(抜粋)**
*注1) VPN ダイアログに利用者IDとパスワードを入力し、その認証が完了すると、セキュリティコード入力画面が表示され、 SMS でセキュリティコードがスマートフォンに送信される。送信されたセキュリティコードを、セキュリティコード入力画面に入力することで認証される。*
| 機能名 | 機能概要 | 設定 |
| :--- | :--- | :--- |
| VPN 通信機能 | VPN クライアントソフトウェアを導入したPCとの間でVPN通信を行う。VPN 接続時の認証方式は、VPN クライアントソフトウェア起動時に表示されるダイアログボックス(以下、VPN ダイアログという)に、利用者IDとパスワードを入力させる方式である。 | 有効 |
| 多要素認証機能 | 利用者 ID とパスワードによる認証方式に次のいずれかの認証方式を組み合わせた多要素認証を行う。<br>(ア) スマートフォンにSMSでセキュリティコードを送り、その入力を確認する方式<sup>1)</sup><br>(イ) デジタル証明書によってクライアント認証を行う方式<br>(ウ) スマートフォンに承認要求のプッシュ通知を送り、その通知の承認を確認することで認証を行う方式 | 無効 |

最近,同業他社でサイバー攻撃による被害が2件立て続けに発生したという報道があった。1件は、VPN-GWが攻撃を受け、社内ネットワークに侵入されて情報漏えいが発生した事案である。もう1件は、DDoS攻撃による被害が発生した事案である。

H社でも同様な事案が発生する可能性について、L部長とT主任が調査することにした。

### 〔VPN-GWへの攻撃に対する調査〕

T主任は、VPN-GWへの攻撃方法を次のようにまとめた。

  - **方法1:** VPN-GWの認証情報を推測し、社内ネットワークに侵入する。
  - **方法2:** VPN-GWの製品名や型番を調査した上で、社内ネットワークへの侵入が可能になる脆弱性を調べる。もし、脆弱性が存在すればその脆弱性を悪用し、社内ネットワークに侵入する。

T主任は、方法1については、VPN-H の認証強化を検討することにした。また、方法2については、VPN-H の脆弱性対策と, VPN-Hへのポートスキャンに対する応答を返さないようにする方法(以下、ステルス化という)を検討することにした。方法1と方法2についてT主任がまとめた対策案を表3に示す。

**表3 方法1と方法2についてT主任がまとめた対策案**
| 攻擊方法 | 対策名 | 内容 |
| :--- | :--- | :--- |
| 方法1 | **V-1: VPN-H の認証強化** | インターネットから VPN-Hへのアクセス時は多要素認証を用いる。 |
| 方法2 | **V-2: VPN-H の脆弱性対策** | (省略) |
| | **V-3: ステルス化** | VPN-H のポートを通常は応答を返さないように設定しておく。H社が許可したPCからのアクセス時だけ、接続を許可する。 |

### 〔DDoS 攻撃に対する調査〕

次に、T主任は、DDoS に関連する攻撃について調査し、H社で未対策のものを表4にまとめた。

**表4 H社で未対策のDDoS に関連する攻撃**
| 項番 | 攻擊 | 例 |
| :--- | :--- | :--- |
| 1 | UDP Flood 攻擊 | 公開 Web サーバ、DNS サーバを攻撃対象に、偽の送信元 IPアドレスとランダムな宛先ポート番号を設定した UDP データグラムを大量に送り付ける |
| 2 | SYN Flood 攻擊 | (省略) |
| 3 | DNS リフレクション攻撃の踏み台にされる | (省略) |
| 4 | HTTP GET Flood 攻擊 | <span style="display:inline-block; border: 1px solid black; padding: 0 10px; text-align: center;">a</span> |

次は、表4についてのT主任とL部長の会話である。
**T主任:** 項番1,2,4のDDoS 攻撃のサーバへの影響は、UTMのIPS機能とWAF機能で軽減することができます。
**L部長:** そうか。機能の設定に関する注意点はあるのかな。
**T主任:** 例えば、アノマリ型IPS機能で、トラフィック量について、しきい値が高すぎる場合にも、①<u>しきい値が低すぎる場合にも弊害が発生する</u>ので、しきい値の設定には注意するようにします。また、項番3の対策として、現在のDNS サーバを廃止して、権威 DNS サーバの機能をもつサーバ(以下,DNS-Kという)とフルサービスリゾルバの機能をもつサーバ(以下、DNS-F という)を社内に新設します。インターネットから社内への DNS 通信は <span style="display:inline-block; border: 1px solid black; padding: 0 10px; text-align: center;">b</span> への通信だけを許可し、社内からインターネットへの DNS 通信は <span style="display:inline-block; border: 1px solid black; padding: 0 10px; text-align: center;">c</span> からの通信だけを許可します。

### 〔対策 V-1についての検討〕

次は、対策 V-1についてのL部長とT主任の会話である。
**L部長:** 対策V-1での注意点はあるのかな。
**T主任:** 最近は、多要素認証の利用が多くなってきたこともあり、多要素認証を狙った攻撃が発生しています。多要素認証を狙った攻撃例を表5に示します。

**表5 多要素認証を狙った攻撃例**
| 攻擊例 | 概要 |
| :--- | :--- |
| **攻擊例1** | 表2 (ア)と組み合わせた多要素認証を突破するフィッシング攻撃であり、次の手順で行われる。<br>(1) 攻撃者が、フィッシングメールを使って、VPN ダイアログの画面を装った罠の Web サイトに正規利用者を誘導し、正規利用者に利用者 IDとパスワードを入力させる。<br>(2) <span style="display:inline-block; border: 1px solid black; padding: 0 10px; text-align: center;">d</span> <br>(3) <span style="display:inline-block; border: 1px solid black; padding: 0 10px; text-align: center;">e</span> <br>(4) 攻撃者が、社内ネットワークに不正に接続する |
| **攻擊例2** | 表2 (ウ)と組み合わせた多要素認証を突破する多要素認証疲労攻撃であり、次の手順で行われる。<br>(省略) |

**L部長:** 攻擊例1については、不正なリモート接続を阻止するために、メールで受信したメッセージ内のURL リンクを安易にクリックしないよう注意喚起する必要があるな。
**T主任:** はい。しかし、当社では、業務の手続の督促などで従業員にURL リンクが含まれるメールを送っているので、URL リンクのクリックを禁止することはできません。不審なURLかどうかを見極めさせることは難しいでしょう。そこで、②<u>たとえ罠のWebサイトへのURL リンクをクリックしてしまっても、不正なリモート接続をされないように、従業員全員が理解できる内容を、注意喚起する必要があります。</u>

### 〔対策 V-3についての検討〕

次は、対策 V-3についてのL部長とT主任の会話である。
**L部長:** 対策V-3について説明してほしい。
**T主任:** VPN-H には、どのような通信要求に対しても応答しない “Deny-ALL" を設定した上で、あらかじめ設定されている順番にポートに通信要求した場合だけ所定のポートへの接続を許可するという設定(以下,設定Pという)があります。
**L部長:** 設定Pの注意点はあるのかな。
**T主任:** 設定されている順番を攻撃者が知らなくても、③<u>攻撃者が何らかの方法でパケットを盗聴できた場合、設定Pを突破されてしまいます。</u>
**L部長:** 設定Pとは別の方法はあるのかな。
**T主任:** VPN-Hの機能にはありませんが、 SPA (Single Packet Authorization) というプロトコルがあります。SPAの主な仕様を表6に示します。

**表6 SPAの主な仕様**
| 項番 | 内容 |
| :--- | :--- |
| 1 | TCPのSYN パケット又はUDPの最初のパケット(以下、SPA パケットという)には、HMACベースのワンタイムパスワードが含まれており、送信元の真正性を送信先が検証できる。検証に成功すれば、以降の通信のパケットは許可される。検証に失敗すれば、以降の通信のパケットは破棄される。 |
| 2 | SPA パケットにはランダムデータが含まれており、送信先で検証される。以前受信したのと同じランダムデータをもつSPA パケットを受信した場合は、破棄される。 |
| 3 | SPA パケットの最後尾フィールドには先行フィールドのハッシュ値が格納されている。送信先では、この値を検証し、検証に失敗すれば、そのパケットは破棄される。 |
| 4 | 送信先では、検証した結果は、送信元に返さない |

**T主任:** SPAなら、④<u>攻撃者が何らかの方法でパケットを盗聴できたとしても、突破はされません。</u>
**L部長:** そうか。VPN 通信機能と同様の機能をもち、SPA を採用している製品があるかどうか、ベンダーに相談してみよう。

L 部長がベンダーに相談したところ、S社が提供しているアプライアンス (以下,S-APPL という)の紹介があった。L部長とT主任は、S-APPL の導入検討を進めた。

### 〔S-APPL の導入検討〕

S-APPLは、VPN通信機能, SPA パケットを検証する機能などをもつ。S-APPLと接続するためには、S-APPL のエージェントソフトウェア (以下, Sソフトという)を接続元のPCに導入し、接続元のPCごとのIDと秘密情報を、S-APPLと接続元のPCそれぞれに設定する必要がある。なお、秘密情報は、SPA パケットのHMAC ベースのワンタイムパスワードの生成などに使われる。S-APPLとSソフトの主な機能を表7に示す。

**表7 S-APPLとSソフトの主な機能**
| 項番 | 機能名 | 機能概要 |
| :--- | :--- | :--- |
| 1 | SPA 機能 | SPA パケットを用いて送信元の真正性を S-APPL が検証する |
| 2 | VPN 通信機能 | S-APPLとSソフトを導入したPCとの間でVPNを確立する。 |
| 3 | 多要素認証機能 | VPN-H の多要素認証機能と同じ機能をもつ。 |
| 4 | 接続サーバ許可機能 | VPN 確立後にアクセス可能なサーバをPCごとに設定する。 |

T主任は、対策 V-1~3について、次のように考えた。

  - 対策 V-1 については、表7項番3の機能で対応する。方式は、表2 (イ)の方式を採用する。
  - 対策 V-2 については、S-APPL の脆弱性情報を収集し、脆弱性修正プログラムが公開されたら、それを適用する。
  - 対策 V-3 については、表7項番1の機能で対応する。

T主任は、対策 V-3のためのH社のネットワーク構成の変更案を作成した。なお、変更する際は、次の対応が必要になる。

1.  VPN-HをS-APPL に置き換える。R-PCには、Sソフトを導入する。
2.  R-PCごとのIDと秘密情報を、S-APPLとR-PC それぞれに設定する。
3.  VPN-Hに付与していたIPアドレスをS-APPL に付与する。
4.  S-APPLのFQDNをDNSサーバに登録する。

T主任は、S-APPL の導入によって VPN-GWへの攻撃の対策が可能であることをL部長に説明した。L部長は、効果とリスクを検討した上で、S-APPL を導入することを決めた。

### [DDoS攻撃に対する具体的対策の検討]

T主任は、表4の項番3以外に対する具体的対策の検討に着手した。
まず、通信回線については、DDoS 攻撃で大量のトラフィックが発生すると、使えなくなる。これについては、通信回線の帯域を大きくするという方法のほか、⑤<u>外部のサービスを利用する</u>という方法があることが分かった。

次に、サーバへの影響は、これまでに検討したUTMのIPS機能とWAF 機能を有効化することで軽減できることが分かっている。加えて、取引先向け Web サーバについては、次の対応によって、⑥<u>更にDDoS 攻撃の影響を軽減できる</u>ことが分かった。

  - 取引先には、H社との取引専用のPC(以下、取引専用 PC という)を貸与する。取引専用PCには、Sソフトを導入する。
  - 取引専用PCごとのIDと秘密情報を、S-APPL と取引専用 PCそれぞれに設定する。S-APPLに、取引専用PCがVPN 確立後にアクセス可能なサーバとして、取引先向けWeb サーバだけを設定する。
  - UTM のファイアウォール機能で、インターネットから取引先向け Web サーバへの通信を拒否するように設定する。

その後、H社では、S-APPL の導入、UTM の設定変更 DNS サーバの変更などを行い、新たな運用を開始した。

-----

### 設問1

〔DDoS 攻撃に対する調査〕について答えよ。
(1) 表4中の <span style="display:inline-block; border: 1px solid black; padding: 0 10px; text-align: center;">a</span> に入れる攻撃の例を、H社での攻撃対象を示して具体的に答えよ。
(2) 本文中の下線①の場合に発生する弊害を 25字以内で答えよ。
(3) 本文中の <span style="display:inline-block; border: 1px solid black; padding: 0 10px; text-align: center;">b</span> 、 <span style="display:inline-block; border: 1px solid black; padding: 0 10px; text-align: center;">c</span> に入れる適切な字句を、 “DNS-F”又は“DNS-K” から選び答えよ。

### 設問2

【対策 V-1 についての検討] について答えよ。
(1) 表5中の <span style="display:inline-block; border: 1px solid black; padding: 0 10px; text-align: center;">d</span> 、 <span style="display:inline-block; border: 1px solid black; padding: 0 10px; text-align: center;">e</span> に入れる、不正な接続までの攻撃手順を、具体的に答えよ。
(2) 本文中の下線②について、注意喚起の内容を、具体的に答えよ。

### 設問3

〔対策 V-3についての検討〕について答えよ。
(1) 本文中の下線③について、設定Pを突破する方法を 30字以内で答えよ。
(2) 本文中の下線④について、突破されないのはなぜか。40字以内で答えよ。

### 設問4

[DDoS攻撃に対する具体的対策の検討] について答えよ。
(1) 本文中の下線⑤について、利用する外部のサービスを、20字以内で具体的に答えよ。
(2) 本文中の下線⑥について、軽減できる理由を、40字以内で答えよ。

-----
